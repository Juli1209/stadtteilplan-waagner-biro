<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta -->
  <meta charset="utf-8" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Use the .htaccess and remove these lines to avoid edge case issues.
     More info: h5bp.com/i/378 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

  <!-- Our site title and description -->
  <title>TransforMap-Viewer</title>
  <meta name="description" content="TransforMap Viewer allows you to visualize the myriads of alternatives to the dominant economic system." />
  <meta name="keywords" content="openstreetmap, OSM, Free Software, Open Source, mapping, leaflet, linked data, mapping taxonomy, open data, solidarity economy, alternative economy" />
  <meta name="author" content="TransforMap Community" />

  <meta property="og:title" content="TransforMap-Viewer" />
  <meta property="og:type" content="website" />
  <meta property="og:description" content="TransforMap Viewer allows you to visualize the myriads of alternatives to the dominant economic system." />
  <meta property="og:url" content="https://github.com/TransforMap/transformap-viewer" />

  <!-- Mobile viewport optimized: h5bp.com/viewport -->
  <meta name="viewport" content="width=device-width" />

  <!-- Icons -->
  <link rel="shortcut icon" href="http://transformap.co/images/favicon.png">

  <!-- Shims: IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script async src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- Styles -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin,latin-ext" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700,700italic&subset=latin,latin-ext" />
  <link rel="stylesheet" href="bower_components/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="bower_components/PruneCluster/dist/LeafletStyleSheet.css" />
  <link rel="stylesheet" href="styles/css/style.css" />
</head>

<body id="map">

  <!-- Content -->

  <script type='template' id='menuCategoryTemplate'>
    <li class="list-group-item category <%- id %>">
      <span class="toggle" onClick="clickOnCat('<%- id %>')"><%- itemLabel %>
        <span class="expert_mode off">
          <span onClick="clickPlus('<%- id %>')" class="add">+</span><span onClick="clickMinus('<%- id %>')" class="remove inactive">-</span>
        </span>
      </span>
      <ul class="subcategories"></ul>
      <ul class="type-of-initiative"></ul>
    </li>
  </script>

  <script type='template' id='menuTypeOfInitiativeTemplate'>
    <li class="list-group-item empty <%- id %>" onClick="clickOnInitiative('<%- id %>')">
      <%- itemLabel %>
        <span class="expert_mode off">
          <span onClick="clickPlus('<%- id %>')" class="add">+</span><span onClick="clickMinus('<%- id %>')" class="remove inactive">-</span>
        </span>
    </li>
  </script>

  <script type='template' id='popUpTemplate'>
    <h1>
      <%- properties.name %>
    </h1>
    <% if (properties['image']) { %>
      <p>
        <a href="<%- properties.image %>" target=_blank>
          <img src="<%- checkForMWimages(properties.image) %>">
        </a>
        <br>
        <em><%- properties['image:license'] %> <%- properties['image:credit'] %></em>
      </p>
    <% } %>
    <p>
      <%- properties.description  %>
    </p>

      <h3><%- T("address") %></h3>
    <p>
      <%- properties['addr:housenumber'] %> <%- (properties['addr:housename']) ? properties['addr:housename'] + "," : "" %> <%- properties['addr:street'] %><br><%- properties['addr:postcode'] %> <%- properties['addr:city'] %>, <%- properties['addr:country'] %>
    </p>

    <% if ((properties['contact:email']) || (properties['contact:website']) || (properties['contact:phone']) || (properties['website'])) { %>
    <h3><%- T("contact") %></h3>
    <p>
       <% if (properties['contact:email']) { %>
      <a href="mailto:<%- properties['contact:email'] %>"><%- properties['contact:email'] %></a>
      <br>
      <% } %>
       <% if (properties['contact:website']) { %>
      <a href="<%- properties['contact:website'] %>"><%- properties['contact:website'] %></a>
      <br>
      <% } %>
       <% if (properties['website']) { %>
      <a href="<%- properties['website'] %>"><%- properties['website'] %></a>
      <br>
      <% } %>
       <% if (properties['contact:phone']) { %>
      <a href="tel:<%- properties['contact:phone'] %>"><%- properties['contact:phone'] %></a>
      <% } %>
    </p>
    <% } %>


    <% if (properties['opening_hours:url']) { %>
      <h3><%- T("opening_hours") %></h3>
      <p>
        <a href="<%- properties['opening_hours:url'] %>"><%- properties['opening_hours:url'] %></a>
      </p>
    <% } %>
        <h3><%- T("type_of_initiative") %></h3>
      <p>
        <% var tois_array = createToiArray(properties['type_of_initiative']);
           var trans_array = tois_array.map(function(obj){
             var qnr = tax_hashtable.toistr_to_qnr[obj];
             return (qnr) ? tax_hashtable.toi_qindex[qnr].itemLabel.value : obj;
           });
           var trans_str = trans_array.join(', '); %>
        <%- trans_str %>
      </p>
  </script>

  <div id="map-menu-container" class="col-lg-2 col-md-3 col-sm-3 col-xs-12">
    <ul id="map-menu" class="list-group">

    </ul>

    <div id=resetfilters onClick="resetFilter();" title="click to reset filters">Reset filters</div>
    <div id=mobileShowMap onClick="switchToMap();" title="back to map">Show Map</div>
    <div id=toggleAdvancedFilters onClick="toggleAdvancedFilterMode();" title="Switch to Advanced Mode for filters" mode="simple">Enable Advanced Filter Mode</div>

    <div id=activefilters>
      <h2 class="expert_mode off">Active Filters:</h2>
      <ul class="expert_mode off">
      </ul>
    </div>

    <div id=languageSelector onClick="$('#languageSelector ul').toggleClass('open');">
      <span lang=en>Choose Language:</span>
      <ul></ul>
    </div>

  </div>

  <div class="col-lg-10 col-md-9 col-sm-9 col-xs-12">
    <div id='map-template'>
      <div id="map-tiles"></div>
      <div id="showfilters" title="show filters" onClick="switchToMenu();"></div>
    </div>
  </div>


  <!-- Scripts -->
  <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.js"></script>
  <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
  <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"></script>
  <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.0/backbone-min.js"></script>
  <script defer="defer" src="bower_components/leaflet/dist/leaflet.js"></script>
  <script defer="defer" src="scripts/leaflet-hash.js"></script>
  <script defer="defer" src="bower_components/PruneCluster/dist/PruneCluster.min.js"></script>
  <script defer="defer" src="scripts/map.js"></script>
</body>
</html>
